

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>2. Pandas &#8212; Técnicas de Machine Learning con Python</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=12da95d707ffb74b382d" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=12da95d707ffb74b382d" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=12da95d707ffb74b382d" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=12da95d707ffb74b382d" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=12da95d707ffb74b382d" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=12da95d707ffb74b382d" />

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Pandas';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="3. Gráficos básicos: matplotlib &amp; seaborn" href="Visualizacion.html" />
    <link rel="prev" title="1. Python, una introducción" href="IntroduccionPython.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.jpg" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="_static/logo.jpg" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Machine Learning con Python
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Introducción a Python</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="IntroduccionPython.html">1. Python, una introducción</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">2. Pandas</a></li>
<li class="toctree-l1"><a class="reference internal" href="Visualizacion.html">3. Gráficos básicos: matplotlib &amp; seaborn</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Análisis Exploratorio de Datos</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Descriptiva.html">4. Estadística Descriptiva</a></li>
<li class="toctree-l1"><a class="reference internal" href="PruebasHipotesis.html">5. Pruebas de Hipótesis</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Aprendizaje Supervizado</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="IntroML.html">6. Machine Learning</a></li>
<li class="toctree-l1"><a class="reference internal" href="AprendizajeSupervisado.html">7. Aprendizaje Supervisado</a></li>
<li class="toctree-l1"><a class="reference internal" href="Regresion.html">8. Regresión lineal</a></li>
<li class="toctree-l1"><a class="reference internal" href="ProbModels.html">9. Modelos de Probabilidad</a></li>
<li class="toctree-l1"><a class="reference internal" href="StepRegularization.html">10. Selección y regularización de modelos lineales</a></li>
<li class="toctree-l1"><a class="reference internal" href="Arboles.html">11. Árboles de decisión</a></li>
<li class="toctree-l1"><a class="reference internal" href="SVM.html">12. Support Vector Machines</a></li>
<li class="toctree-l1"><a class="reference internal" href="RedesNeuronales.html">13. Redes Neuronales</a></li>
<li class="toctree-l1"><a class="reference internal" href="Evaluacion.html">14. Evaluación de Modelos</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Aprendizaje no Supervisado</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="ACP.html">15. Análisis de Componentes Principales</a></li>
<li class="toctree-l1"><a class="reference internal" href="NoSupervizado.html">16. Clustering</a></li>
<li class="toctree-l1"><a class="reference internal" href="ReglasAso.html">17. Minería de Reglas de asociación</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/vmoprojs/MLPython" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/vmoprojs/MLPython/issues/new?title=Issue%20on%20page%20%2FPandas.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/Pandas.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Pandas</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#las-series">2.1. Las Series</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#haciendo-consultas-en-series">2.2. Haciendo consultas en Series</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pandas-estructuras-de-datos-para-estadistica">2.3. Pandas: estructuras de datos para estadística</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#manipulacion-de-datos">2.3.1. Manipulación de datos</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cargando-nuestro-primer-conjunto-de-datos">2.3.2. Cargando nuestro primer conjunto de datos</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#columnas-filas-y-celdas">2.3.3. Columnas, filas y celdas</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#seleccionar-e-indexar-columnas-por-nombre">2.3.4. Seleccionar e indexar columnas por nombre</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#usando-notacion-para-acceder-a-valores-de-columna">2.3.5. Usando notación “.” para acceder a valores de columna</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#subconjunto-de-filas">2.3.6. Subconjunto de filas</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#usando-iloc">2.3.7. Usando <code class="docutils literal notranslate"><span class="pre">.iloc</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#agrupaciones">2.3.8. Agrupaciones</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#wide-long">2.3.9. Wide &amp; Long</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pivot-table">2.3.9.1. .pivot_table</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#melt">2.3.9.2. .melt</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#merge">2.3.10. Merge</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#datos-categoricos">2.3.11. Datos categóricos</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tablas-dinamicas">2.3.12. Tablas dinámicas</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#apply">2.3.13. Apply</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#concat">2.3.13.1. .concat</a></li>
</ul>
</li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="pandas">
<h1><span class="section-number">2. </span>Pandas<a class="headerlink" href="#pandas" title="Permalink to this heading">#</a></h1>
<p><strong>Series</strong>: es una matriz etiquetada <strong>unidimensional</strong> capaz de contener cualquier tipo de datos (enteros, cadenas, números de punto flotante, objetos de Python, etc.). Las etiquetas de los <strong>ejes</strong> (axis) se denominan colectivamente índice (index). El método básico para crear una serie es llamar a <code class="docutils literal notranslate"><span class="pre">pd.Series([1,3,5,np.nan,6,8])</span></code>.</p>
<p><strong>DataFrame</strong>: Es una estructura de datos etiquetada <strong>bidimensional</strong> con columnas de tipos potencialmente diferentes. Se puede considerar como una hoja de cálculo o una tabla SQL, o un diccionario de objetos Series. Proviene del objeto <code class="docutils literal notranslate"><span class="pre">data.frame()</span></code> de <code class="docutils literal notranslate"><span class="pre">R</span></code>.</p>
<section id="las-series">
<h2><span class="section-number">2.1. </span>Las Series<a class="headerlink" href="#las-series" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="c1">#pd.Series?</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">animales</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Tigre&#39;</span><span class="p">,</span> <span class="s1">&#39;Oso&#39;</span><span class="p">,</span> <span class="s1">&#39;Alce&#39;</span><span class="p">]</span>
<span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">animales</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    Tigre
1      Oso
2     Alce
dtype: object
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">animales</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Tigre&#39;</span><span class="p">,</span> <span class="s1">&#39;Oso&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>
<span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">animales</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    Tigre
1      Oso
2     None
dtype: object
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">numbers</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>
<span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">numbers</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    1.0
1    2.0
2    NaN
dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">np</span><span class="o">.</span><span class="n">nan</span> <span class="o">==</span> <span class="kc">None</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>False
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">nan</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>False
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sports</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Futbol&#39;</span><span class="p">:</span> <span class="s1">&#39;Ecuador&#39;</span><span class="p">,</span>
          <span class="s1">&#39;Golf&#39;</span><span class="p">:</span> <span class="s1">&#39;Escocia&#39;</span><span class="p">,</span>
          <span class="s1">&#39;Sumo&#39;</span><span class="p">:</span> <span class="s1">&#39;Japon&#39;</span><span class="p">,</span>
          <span class="s1">&#39;Taekwondo&#39;</span><span class="p">:</span> <span class="s1">&#39;Corea del Sur&#39;</span><span class="p">}</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">sports</span><span class="p">)</span>
<span class="n">s</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Futbol             Ecuador
Golf               Escocia
Sumo                 Japon
Taekwondo    Corea del Sur
dtype: object
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s</span><span class="o">.</span><span class="n">index</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;Futbol&#39;, &#39;Golf&#39;, &#39;Sumo&#39;, &#39;Taekwondo&#39;], dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="s1">&#39;Tigre&#39;</span><span class="p">,</span> <span class="s1">&#39;Oso&#39;</span><span class="p">,</span> <span class="s1">&#39;Alce&#39;</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;India&#39;</span><span class="p">,</span> <span class="s1">&#39;America&#39;</span><span class="p">,</span> <span class="s1">&#39;Canada&#39;</span><span class="p">])</span>
<span class="n">s</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>India      Tigre
America      Oso
Canada      Alce
dtype: object
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sports</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Futbol&#39;</span><span class="p">:</span> <span class="s1">&#39;Ecuador&#39;</span><span class="p">,</span>
          <span class="s1">&#39;Golf&#39;</span><span class="p">:</span> <span class="s1">&#39;Escocia&#39;</span><span class="p">,</span>
          <span class="s1">&#39;Sumo&#39;</span><span class="p">:</span> <span class="s1">&#39;Japon&#39;</span><span class="p">,</span>
          <span class="s1">&#39;Taekwondo&#39;</span><span class="p">:</span> <span class="s1">&#39;Corea del Sur&#39;</span><span class="p">}</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">sports</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Golf&#39;</span><span class="p">,</span> <span class="s1">&#39;Sumo&#39;</span><span class="p">,</span> <span class="s1">&#39;Hockey&#39;</span><span class="p">])</span>
<span class="n">s</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Golf      Escocia
Sumo        Japon
Hockey        NaN
dtype: object
</pre></div>
</div>
</div>
</div>
</section>
<section id="haciendo-consultas-en-series">
<h2><span class="section-number">2.2. </span>Haciendo consultas en Series<a class="headerlink" href="#haciendo-consultas-en-series" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sports</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Futbol&#39;</span><span class="p">:</span> <span class="s1">&#39;Ecuador&#39;</span><span class="p">,</span>
          <span class="s1">&#39;Golf&#39;</span><span class="p">:</span> <span class="s1">&#39;Escocia&#39;</span><span class="p">,</span>
          <span class="s1">&#39;Sumo&#39;</span><span class="p">:</span> <span class="s1">&#39;Japon&#39;</span><span class="p">,</span>
          <span class="s1">&#39;Taekwondo&#39;</span><span class="p">:</span> <span class="s1">&#39;Corea del Sur&#39;</span><span class="p">}</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">sports</span><span class="p">)</span>
<span class="n">s</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Futbol             Ecuador
Golf               Escocia
Sumo                 Japon
Taekwondo    Corea del Sur
dtype: object
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;Corea del Sur&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;Golf&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;Escocia&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;Corea del Sur&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s</span><span class="p">[</span><span class="s1">&#39;Golf&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;Escocia&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sports</span> <span class="o">=</span> <span class="p">{</span><span class="mi">99</span><span class="p">:</span> <span class="s1">&#39;Ecuador&#39;</span><span class="p">,</span>
          <span class="mi">100</span><span class="p">:</span> <span class="s1">&#39;Escocia&#39;</span><span class="p">,</span>
          <span class="mi">101</span><span class="p">:</span> <span class="s1">&#39;Japon&#39;</span><span class="p">,</span>
          <span class="mi">102</span><span class="p">:</span> <span class="s1">&#39;Corea del Sur&#39;</span><span class="p">}</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">sports</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#  s[0] # no se hace la consulta</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mf">100.00</span><span class="p">,</span> <span class="mf">120.00</span><span class="p">,</span> <span class="mf">101.00</span><span class="p">,</span> <span class="mf">3.00</span><span class="p">])</span>
<span class="n">s</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    100.0
1    120.0
2    101.0
3      3.0
dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">total</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">s</span><span class="p">:</span>
    <span class="n">total</span><span class="o">+=</span><span class="n">item</span>
<span class="nb">print</span><span class="p">(</span><span class="n">total</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>324.0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="n">s</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;Animal&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Bears&#39;</span> <span class="c1"># agregamos un elemento a la serie</span>
<span class="n">s</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0             1
1             2
2             3
Animal    Bears
dtype: object
</pre></div>
</div>
</div>
</div>
</section>
<section id="pandas-estructuras-de-datos-para-estadistica">
<h2><span class="section-number">2.3. </span>Pandas: estructuras de datos para estadística<a class="headerlink" href="#pandas-estructuras-de-datos-para-estadistica" title="Permalink to this heading">#</a></h2>
<p>Provee estructuras de datos adecuados para análisis estadístico, y añade funciones que  facilitan el ingreso de datos, su organización y su manipulación.</p>
<section id="manipulacion-de-datos">
<h3><span class="section-number">2.3.1. </span>Manipulación de datos<a class="headerlink" href="#manipulacion-de-datos" title="Permalink to this heading">#</a></h3>
<p><strong>Procedimientos comunes</strong></p>
<p>Un <em>DataFrame</em> es una estructura de datos de dos dimensiones con etiquetas cuyas columnas pueden ser de diferentes tipos.</p>
<p>Empecemos creando un DataFrame con tres columnas <em>Time</em>, <em>x</em> y <em>y</em></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mf">0.1</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;Time&#39;</span><span class="p">:</span><span class="n">t</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span><span class="n">x</span><span class="p">,</span><span class="s1">&#39;y&#39;</span><span class="p">:</span><span class="n">y</span><span class="p">})</span>
</pre></div>
</div>
</div>
</div>
<p>En <em>pandas</em> las filas se referencian por índices y las columnas por nombres. Si si desea la primera columna se tiene dos opciones:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">Time</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0     0.0
1     0.1
2     0.2
3     0.3
4     0.4
     ... 
95    9.5
96    9.6
97    9.7
98    9.8
99    9.9
Name: Time, Length: 100, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>Si se desea extraer más de una columna, se lo hace con una lista:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s1">&#39;Time&#39;</span><span class="p">,</span><span class="s1">&#39;x&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
<p>Para despleguar las primeras o últimas filas tenemos:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
<span class="n">data</span><span class="o">.</span><span class="n">tail</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Time</th>
      <th>x</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>95</th>
      <td>9.5</td>
      <td>-0.075151</td>
    </tr>
    <tr>
      <th>96</th>
      <td>9.6</td>
      <td>-0.174327</td>
    </tr>
    <tr>
      <th>97</th>
      <td>9.7</td>
      <td>-0.271761</td>
    </tr>
    <tr>
      <th>98</th>
      <td>9.8</td>
      <td>-0.366479</td>
    </tr>
    <tr>
      <th>99</th>
      <td>9.9</td>
      <td>-0.457536</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Para extraer las filas de la 5 a la 10 tenemos:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="mi">4</span><span class="p">:</span><span class="mi">10</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Time</th>
      <th>x</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>4</th>
      <td>0.4</td>
      <td>0.389418</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.5</td>
      <td>0.479426</td>
    </tr>
    <tr>
      <th>6</th>
      <td>0.6</td>
      <td>0.564642</td>
    </tr>
    <tr>
      <th>7</th>
      <td>0.7</td>
      <td>0.644218</td>
    </tr>
    <tr>
      <th>8</th>
      <td>0.8</td>
      <td>0.717356</td>
    </tr>
    <tr>
      <th>9</th>
      <td>0.9</td>
      <td>0.783327</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>El manejo de <em>DataFrames</em> es un tanto diferente de arrays en <em>numpy</em>. Por ejemplo, filas (enumeradas) y columnas (etiquetadas) se acceden de forma simultánea de la siguiente manera:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[[</span><span class="s1">&#39;Time&#39;</span><span class="p">,</span><span class="s1">&#39;y&#39;</span><span class="p">]][</span><span class="mi">4</span><span class="p">:</span><span class="mi">10</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Time</th>
      <th>y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>4</th>
      <td>0.4</td>
      <td>0.921061</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.5</td>
      <td>0.877583</td>
    </tr>
    <tr>
      <th>6</th>
      <td>0.6</td>
      <td>0.825336</td>
    </tr>
    <tr>
      <th>7</th>
      <td>0.7</td>
      <td>0.764842</td>
    </tr>
    <tr>
      <th>8</th>
      <td>0.8</td>
      <td>0.696707</td>
    </tr>
    <tr>
      <th>9</th>
      <td>0.9</td>
      <td>0.621610</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>También se puede usar la manera estándar de fila/columna usando <code class="docutils literal notranslate"><span class="pre">iloc</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">4</span><span class="p">:</span><span class="mi">10</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Time</th>
      <th>y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>4</th>
      <td>0.4</td>
      <td>0.921061</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.5</td>
      <td>0.877583</td>
    </tr>
    <tr>
      <th>6</th>
      <td>0.6</td>
      <td>0.825336</td>
    </tr>
    <tr>
      <th>7</th>
      <td>0.7</td>
      <td>0.764842</td>
    </tr>
    <tr>
      <th>8</th>
      <td>0.8</td>
      <td>0.696707</td>
    </tr>
    <tr>
      <th>9</th>
      <td>0.9</td>
      <td>0.621610</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Finalmente, a veces se desea tener acceso directo a los datos, no al DataFrame, se usa:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># df.values</span>
</pre></div>
</div>
</div>
</div>
<p>Lo que devuelve un <em>numpy array</em></p>
<p><strong>Notas en Selección de datos</strong></p>
<p>Es cierto que <em>DataFrames</em> y <em>arrays</em> son parecidos, pero sus filosofías son diferentes. Es bueno tener muy claro sus diferencias para acceder a los datos:</p>
<ul class="simple">
<li><p><strong>numpy</strong>: maneja <em>filas</em> primero. Ej., <code class="docutils literal notranslate"><span class="pre">data[0]</span></code> es la primera fila del array</p></li>
<li><p><strong>pandas</strong>: empieza con columnas. Ej., <code class="docutils literal notranslate"><span class="pre">df['values'][0]</span></code> es el primer elemento de la columna <em>values</em>.</p></li>
</ul>
<p>Si un DataFrame tiene filas con etiquetas, puedes por ejemplo extraer la fila <em>rowlabel</em> con <code class="docutils literal notranslate"><span class="pre">df.loc['rowlabel']</span></code>. Si quieres acceder con el número de la fila, se hace con <code class="docutils literal notranslate"><span class="pre">df.iloc[15]</span></code>. También puedes usar <code class="docutils literal notranslate"><span class="pre">iloc</span></code> para acceder a datos en formato fila/columna <code class="docutils literal notranslate"><span class="pre">df.ioc[2:4,3]</span></code></p>
<p>Extraer filas también funciona, por ejemplo <code class="docutils literal notranslate"><span class="pre">df[0:5]</span></code> para las primeras 5 filas. Lo que suele ser confuso es que para extraer una única fila se usa por ejmeplo <code class="docutils literal notranslate"><span class="pre">df[5:6]</span></code>. Si usas solo <code class="docutils literal notranslate"><span class="pre">df[5]</span></code> se devuelve un error.</p>
</section>
<section id="cargando-nuestro-primer-conjunto-de-datos">
<h3><span class="section-number">2.3.2. </span>Cargando nuestro primer conjunto de datos<a class="headerlink" href="#cargando-nuestro-primer-conjunto-de-datos" title="Permalink to this heading">#</a></h3>
<blockquote>
<div><p>El conjunto de datos <em>Gapminder</em> viene originalmente de www.gapminder.org. La versión que exploraremos fue preparada por Jenifer Bryan de la Universidad de Columbia. Su repositorio puede encontrarse en https://github.com/jennybc/gapminder</p>
</div></blockquote>
<p>Pandas tiene varias funciones de lectura de datos:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">read_csv</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">read_json</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">read_excel</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">read_spss</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">read_stata</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">...</span></code></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="n">uu</span> <span class="o">=</span> <span class="s2">&quot;https://raw.githubusercontent.com/vmoprojs/DataLectures/master/gapminder.csv&quot;</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">uu</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Veamos algunos valores de la tabla:</p>
<ul class="simple">
<li><p>country: país</p></li>
<li><p>continent: continente.</p></li>
<li><p>year: año.</p></li>
<li><p>lifeExp: esperanza de vida.</p></li>
<li><p>pop: población.</p></li>
<li><p>gdpPercap: producto interno bruto per cápita.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>          country continent  year  lifeExp       pop   gdpPercap
0     Afghanistan      Asia  1952   28.801   8425333  779.445314
1     Afghanistan      Asia  1957   30.332   9240934  820.853030
2     Afghanistan      Asia  1962   31.997  10267083  853.100710
3     Afghanistan      Asia  1967   34.020  11537966  836.197138
4     Afghanistan      Asia  1972   36.088  13079460  739.981106
...           ...       ...   ...      ...       ...         ...
1699     Zimbabwe    Africa  1987   62.351   9216418  706.157306
1700     Zimbabwe    Africa  1992   60.377  10704340  693.420786
1701     Zimbabwe    Africa  1997   46.809  11404948  792.449960
1702     Zimbabwe    Africa  2002   39.989  11926563  672.038623
1703     Zimbabwe    Africa  2007   43.487  12311143  469.709298

[1704 rows x 6 columns]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">df</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
</pre></div>
</div>
</div>
</div>
<p>Todo <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> tiene un atributo <code class="docutils literal notranslate"><span class="pre">shape</span></code> que nos devuelve el número de filas y columnas del <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> en forma de tupla.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(1704, 6)
</pre></div>
</div>
</div>
</div>
<p>Nota que no se usa paréntesis luego de <code class="docutils literal notranslate"><span class="pre">shape</span></code>. Esto se debe a que <code class="docutils literal notranslate"><span class="pre">shape</span></code> es un <strong>atributo</strong> del <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>, no un <strong>método</strong> donde si se requiere usar paréntesis. Te devolvería un error si agregaras un paréntesis.</p>
<p>Para ver el nombre de las columnas, usamos el atributo <code class="docutils literal notranslate"><span class="pre">columns</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;country&#39;, &#39;continent&#39;, &#39;year&#39;, &#39;lifeExp&#39;, &#39;pop&#39;, &#39;gdpPercap&#39;], dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<p>Cada columna (Serie) tiene que ser  del mismo tipo, mientras que cada fila puede tener distintos tipos.</p>
<p>Veamos los tipos de datos de las columnas de nuestros datos usando el atrbuto <code class="docutils literal notranslate"><span class="pre">dtypes</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">dtypes</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>country       object
continent     object
year           int64
lifeExp      float64
pop            int64
gdpPercap    float64
dtype: object
</pre></div>
</div>
</div>
</div>
<p>El tipo de dato <code class="docutils literal notranslate"><span class="pre">object</span></code> es el más flexible porque puede almacenar cualquier objeto de Python, incluidos cadenas de texto (<code class="docutils literal notranslate"><span class="pre">strings</span></code>), listas, diccionarios y objetos personalizados. El uso más común es para almacenar <code class="docutils literal notranslate"><span class="pre">strings</span></code>. Las operaciones con <code class="docutils literal notranslate"><span class="pre">object</span></code> podría ser más lento que con el tipo más específico, si se requiere hacer operaciones se recomienda cambiar el tipo de objecto al específico deseado (<code class="docutils literal notranslate"><span class="pre">string</span></code> ,<code class="docutils literal notranslate"><span class="pre">int</span></code> ,<code class="docutils literal notranslate"><span class="pre">float</span></code>,etc )</p>
<p>Para más detalle, usamos el método <code class="docutils literal notranslate"><span class="pre">info</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">info</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 1704 entries, 0 to 1703
Data columns (total 6 columns):
 #   Column     Non-Null Count  Dtype  
---  ------     --------------  -----  
 0   country    1704 non-null   object 
 1   continent  1704 non-null   object 
 2   year       1704 non-null   int64  
 3   lifeExp    1704 non-null   float64
 4   pop        1704 non-null   int64  
 5   gdpPercap  1704 non-null   float64
dtypes: float64(2), int64(2), object(2)
memory usage: 80.0+ KB
None
</pre></div>
</div>
</div>
</div>
</section>
<section id="columnas-filas-y-celdas">
<h3><span class="section-number">2.3.3. </span>Columnas, filas y celdas<a class="headerlink" href="#columnas-filas-y-celdas" title="Permalink to this heading">#</a></h3>
<p>Para inspeccionar los datos del <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> podemos apalancarnos en métodos. Por ejemplo, <code class="docutils literal notranslate"><span class="pre">head</span></code> nos permite ver las primeras 5 filas de los datos</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>       country continent  year  lifeExp       pop   gdpPercap
0  Afghanistan      Asia  1952   28.801   8425333  779.445314
1  Afghanistan      Asia  1957   30.332   9240934  820.853030
2  Afghanistan      Asia  1962   31.997  10267083  853.100710
3  Afghanistan      Asia  1967   34.020  11537966  836.197138
4  Afghanistan      Asia  1972   36.088  13079460  739.981106
</pre></div>
</div>
</div>
</div>
</section>
<section id="seleccionar-e-indexar-columnas-por-nombre">
<h3><span class="section-number">2.3.4. </span>Seleccionar e indexar columnas por nombre<a class="headerlink" href="#seleccionar-e-indexar-columnas-por-nombre" title="Permalink to this heading">#</a></h3>
<p>Para acceder a columnas específicas de nuestros datos, podemos usar corchetes <code class="docutils literal notranslate"><span class="pre">[]</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">country_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;country&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">country_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    Afghanistan
1    Afghanistan
2    Afghanistan
3    Afghanistan
4    Afghanistan
Name: country, dtype: object
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">country_df</span><span class="o">.</span><span class="n">tail</span><span class="p">()</span><span class="c1"># muestra las últimas filas del df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1699    Zimbabwe
1700    Zimbabwe
1701    Zimbabwe
1702    Zimbabwe
1703    Zimbabwe
Name: country, dtype: object
</pre></div>
</div>
</div>
</div>
<p>Para acceder a varias columnas, dentro del primer corchete, le pasamos una lista de nombres</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">subset</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s1">&#39;country&#39;</span><span class="p">,</span> <span class="s1">&#39;continent&#39;</span><span class="p">,</span><span class="s1">&#39;year&#39;</span><span class="p">]]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">subset</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>          country continent  year
0     Afghanistan      Asia  1952
1     Afghanistan      Asia  1957
2     Afghanistan      Asia  1962
3     Afghanistan      Asia  1967
4     Afghanistan      Asia  1972
...           ...       ...   ...
1699     Zimbabwe    Africa  1987
1700     Zimbabwe    Africa  1992
1701     Zimbabwe    Africa  1997
1702     Zimbabwe    Africa  2002
1703     Zimbabwe    Africa  2007

[1704 rows x 3 columns]
</pre></div>
</div>
</div>
</div>
<p>Usando la notación con corchetes <code class="docutils literal notranslate"><span class="pre">[]</span></code>, <strong>no se puede</strong> pasar un número que indique la posición. Para ello usamos <code class="docutils literal notranslate"><span class="pre">.iloc[]</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">5</span><span class="p">:</span><span class="mi">10</span><span class="p">,[</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>lifeExp</th>
      <th>year</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>5</th>
      <td>38.438</td>
      <td>1977</td>
    </tr>
    <tr>
      <th>6</th>
      <td>39.854</td>
      <td>1982</td>
    </tr>
    <tr>
      <th>7</th>
      <td>40.822</td>
      <td>1987</td>
    </tr>
    <tr>
      <th>8</th>
      <td>41.674</td>
      <td>1992</td>
    </tr>
    <tr>
      <th>9</th>
      <td>41.763</td>
      <td>1997</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<blockquote>
<div><p>Indica la diferencia en los tipos de objectos que se obtienen si se tiene:</p>
</div></blockquote>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">df['country']</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">df[['country']]</span></code></p></li>
</ul>
</section>
<section id="usando-notacion-para-acceder-a-valores-de-columna">
<h3><span class="section-number">2.3.5. </span>Usando notación “.” para acceder a valores de columna<a class="headerlink" href="#usando-notacion-para-acceder-a-valores-de-columna" title="Permalink to this heading">#</a></h3>
<p>Para acceder a valores del <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> también puedes usar la notación “.”</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">country</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0       Afghanistan
1       Afghanistan
2       Afghanistan
3       Afghanistan
4       Afghanistan
           ...     
1699       Zimbabwe
1700       Zimbabwe
1701       Zimbabwe
1702       Zimbabwe
1703       Zimbabwe
Name: country, Length: 1704, dtype: object
</pre></div>
</div>
</div>
</div>
<p><strong>Advertencias</strong>: Ten cuidado con el nombre de las columnas cuando vas a usar la notación punto.</p>
<ul class="simple">
<li><p>Si el nombre de la columna coincide con el nombre de un atributo (<code class="docutils literal notranslate"><span class="pre">shape</span></code> por ejemplo), entonces el atributo tiene jerarquía y te devolverá el atributo y no la columna.</p></li>
<li><p>Si el nombre de la columna tiene espacios o caracteres especiales, no puedes usar la notación punto y solo puedes usar el acceso con corchetes.</p></li>
</ul>
</section>
<section id="subconjunto-de-filas">
<h3><span class="section-number">2.3.6. </span>Subconjunto de filas<a class="headerlink" href="#subconjunto-de-filas" title="Permalink to this heading">#</a></h3>
<table class="table">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Atributo</p></th>
<th class="head text-center"><p>Descripción</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">loc</span></code></p></td>
<td class="text-center"><p>Subconjunto basado en la etiqueta del índice</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">iloc</span></code></p></td>
<td class="text-center"><p>Subconjunto basado en el número de la fila</p></td>
</tr>
</tbody>
</table>
<p>Accedamos a los datos con la etiqueta del índice en nuestros datos</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="c1"># nota que &#39;0&#39; no representa un número en este caso, sino la etiqueta de la fila</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>country      Afghanistan
continent           Asia
year                1952
lifeExp           28.801
pop              8425333
gdpPercap     779.445314
Name: 0, dtype: object
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><p>Indica la diferencia entre</p>
</div></blockquote>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">subset_loc</span> <span class="pre">=</span> <span class="pre">df.loc[0]</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">subset_head</span> <span class="pre">=</span> <span class="pre">df.head(n=1)</span></code></p></li>
</ul>
<p>Podemos acceder a varias filas usando las etiquetas de fila:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">451</span><span class="p">]])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>         country continent  year  lifeExp       pop    gdpPercap
0    Afghanistan      Asia  1952   28.801   8425333   779.445314
30       Algeria    Africa  1982   61.368  20033753  5745.160213
451      Ecuador  Americas  1987   67.231   9545158  6481.776993
</pre></div>
</div>
</div>
</div>
</section>
<section id="usando-iloc">
<h3><span class="section-number">2.3.7. </span>Usando <code class="docutils literal notranslate"><span class="pre">.iloc</span></code><a class="headerlink" href="#usando-iloc" title="Permalink to this heading">#</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">.iloc</span></code> hace lo mismo que <code class="docutils literal notranslate"><span class="pre">.loc</span></code> pero usando números que representan las posiciones de la fila. Solo recuerda a las etiquetas de fila pueden o no ser números.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="c1"># accedo a la segunda fila porque inicia en 0.</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>country      Afghanistan
continent           Asia
year                1957
lifeExp           30.332
pop              9240934
gdpPercap      820.85303
Name: 1, dtype: object
</pre></div>
</div>
</div>
</div>
<p>Con ‘.iloc’ podemos usar el índice <code class="docutils literal notranslate"><span class="pre">-1</span></code> para acceder a la última fila (esto no es posible con <code class="docutils literal notranslate"><span class="pre">.loc</span></code>)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>country        Zimbabwe
continent        Africa
year               2007
lifeExp          43.487
pop            12311143
gdpPercap    469.709298
Name: 1703, dtype: object
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">451</span><span class="p">]])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>         country continent  year  lifeExp       pop    gdpPercap
0    Afghanistan      Asia  1952   28.801   8425333   779.445314
30       Algeria    Africa  1982   61.368  20033753  5745.160213
451      Ecuador  Americas  1987   67.231   9545158  6481.776993
</pre></div>
</div>
</div>
</div>
</section>
<section id="agrupaciones">
<h3><span class="section-number">2.3.8. </span>Agrupaciones<a class="headerlink" href="#agrupaciones" title="Permalink to this heading">#</a></h3>
<p><em>pandas</em> ofrece funciones poderosas para manejar datos perdidos que suelen ser reemplazados por <em>nan</em> (<em>not a number</em>). También permite realizar manipilaciones más sofisticadas como <em>pivotaje</em>. Por ejemplo, se puede usar DataFrames para hacer grupos y su análisis estadístico de cada grupo.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;Gender&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="s1">&#39;m&#39;</span><span class="p">,</span><span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="s1">&#39;m&#39;</span><span class="p">],</span> 
    <span class="s1">&#39;TV&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">3.4</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">,</span> <span class="mf">2.6</span><span class="p">,</span> <span class="mf">4.7</span><span class="p">,</span> <span class="mf">4.1</span><span class="p">,</span> <span class="mf">4.1</span><span class="p">,</span> <span class="mf">5.1</span><span class="p">,</span> <span class="mf">3.9</span><span class="p">,</span> <span class="mf">3.7</span><span class="p">,</span> <span class="mf">2.1</span><span class="p">,</span> <span class="mf">4.3</span><span class="p">]</span>
<span class="p">})</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Gender</th>
      <th>TV</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>f</td>
      <td>3.4</td>
    </tr>
    <tr>
      <th>1</th>
      <td>f</td>
      <td>3.5</td>
    </tr>
    <tr>
      <th>2</th>
      <td>m</td>
      <td>2.6</td>
    </tr>
    <tr>
      <th>3</th>
      <td>f</td>
      <td>4.7</td>
    </tr>
    <tr>
      <th>4</th>
      <td>m</td>
      <td>4.1</td>
    </tr>
    <tr>
      <th>5</th>
      <td>m</td>
      <td>4.1</td>
    </tr>
    <tr>
      <th>6</th>
      <td>f</td>
      <td>5.1</td>
    </tr>
    <tr>
      <th>7</th>
      <td>m</td>
      <td>3.9</td>
    </tr>
    <tr>
      <th>8</th>
      <td>f</td>
      <td>3.7</td>
    </tr>
    <tr>
      <th>9</th>
      <td>m</td>
      <td>2.1</td>
    </tr>
    <tr>
      <th>10</th>
      <td>m</td>
      <td>4.3</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Agrupamos los datos</span>

<span class="n">grouped</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Gender&#39;</span><span class="p">)</span>
<span class="n">grouped</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="nb">print</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Gender   TV
0      f  3.4
1      f  3.5
3      f  4.7
6      f  5.1
8      f  3.7
   Gender   TV
2       m  2.6
4       m  4.1
5       m  4.1
7       m  3.9
9       m  2.1
10      m  4.3
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
</div></div></div>
</div>
<p>Nota que si imprimes <code class="docutils literal notranslate"><span class="pre">grouped</span></code> solo se imprime espacio de memoria. A partir de la agrupación podemos acceder a las columnas que devuleven objetos tipo Series.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Algunas estadísticas generales</span>
<span class="n">grouped</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th colspan="8" halign="left">TV</th>
    </tr>
    <tr>
      <th></th>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>max</th>
    </tr>
    <tr>
      <th>Gender</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>f</th>
      <td>5.0</td>
      <td>4.080000</td>
      <td>0.769415</td>
      <td>3.4</td>
      <td>3.500</td>
      <td>3.7</td>
      <td>4.7</td>
      <td>5.1</td>
    </tr>
    <tr>
      <th>m</th>
      <td>6.0</td>
      <td>3.516667</td>
      <td>0.926103</td>
      <td>2.1</td>
      <td>2.925</td>
      <td>4.0</td>
      <td>4.1</td>
      <td>4.3</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Graficamos los datos</span>
<span class="n">grouped</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Gender
f    Axes(0.125,0.11;0.775x0.77)
m    Axes(0.125,0.11;0.775x0.77)
dtype: object
</pre></div>
</div>
<img alt="_images/96a26fde0f17a4f67b7487aedbc4067f895908672a5e6a2ef6cff77c1238b546.png" src="_images/96a26fde0f17a4f67b7487aedbc4067f895908672a5e6a2ef6cff77c1238b546.png" />
<img alt="_images/7b05b2b9b461b639981e4958bee671e6e7560596a35756e3eae1a0bed7701489.png" src="_images/7b05b2b9b461b639981e4958bee671e6e7560596a35756e3eae1a0bed7701489.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Separamos los grupos como DataFrames</span>
<span class="n">df_female</span> <span class="o">=</span> <span class="n">grouped</span><span class="o">.</span><span class="n">get_group</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">)</span>
<span class="n">df_female</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Gender</th>
      <th>TV</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>f</td>
      <td>3.4</td>
    </tr>
    <tr>
      <th>1</th>
      <td>f</td>
      <td>3.5</td>
    </tr>
    <tr>
      <th>3</th>
      <td>f</td>
      <td>4.7</td>
    </tr>
    <tr>
      <th>6</th>
      <td>f</td>
      <td>5.1</td>
    </tr>
    <tr>
      <th>8</th>
      <td>f</td>
      <td>3.7</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Obtenemos los datos como un numpy-array</span>
<span class="n">values_female</span> <span class="o">=</span> <span class="n">df_female</span><span class="o">.</span><span class="n">values</span>
<span class="n">values_female</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[&#39;f&#39;, 3.4],
       [&#39;f&#39;, 3.5],
       [&#39;f&#39;, 4.7],
       [&#39;f&#39;, 5.1],
       [&#39;f&#39;, 3.7]], dtype=object)
</pre></div>
</div>
</div>
</div>
<p>Volviendo a nuestro ejemplo con los datos de <strong>gapminder</strong>.</p>
<p>Ejercicio: Agrupar por año y obtener la media de la variable esperanza de vida (<code class="docutils literal notranslate"><span class="pre">lifeExp</span></code>)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;year&quot;</span><span class="p">)[</span><span class="s2">&quot;lifeExp&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>year
1952    49.057620
1957    51.507401
1962    53.609249
1967    55.678290
1972    57.647386
1977    59.570157
1982    61.533197
1987    63.212613
1992    64.160338
1997    65.014676
2002    65.694923
2007    67.007423
Name: lifeExp, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>Ejercicio: Agrupar por año-continente y obtener la media de la variable esperanza de vida (<code class="docutils literal notranslate"><span class="pre">lifeExp</span></code>) y el PIB per cápita (<code class="docutils literal notranslate"><span class="pre">gdpPercap</span></code>).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">multigrupo</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;year&#39;</span><span class="p">,</span><span class="s1">&#39;continent&#39;</span><span class="p">])[[</span><span class="s1">&#39;lifeExp&#39;</span><span class="p">,</span><span class="s1">&#39;gdpPercap&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">multigrupo</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>lifeExp</th>
      <th>gdpPercap</th>
    </tr>
    <tr>
      <th>year</th>
      <th>continent</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="5" valign="top">1952</th>
      <th>Africa</th>
      <td>39.135500</td>
      <td>1252.572466</td>
    </tr>
    <tr>
      <th>Americas</th>
      <td>53.279840</td>
      <td>4079.062552</td>
    </tr>
    <tr>
      <th>Asia</th>
      <td>46.314394</td>
      <td>5195.484004</td>
    </tr>
    <tr>
      <th>Europe</th>
      <td>64.408500</td>
      <td>5661.057435</td>
    </tr>
    <tr>
      <th>Oceania</th>
      <td>69.255000</td>
      <td>10298.085650</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>En ocasiones el código puede legar a ser largo, por lo que el uso de paréntesis nos sirve para escribirlo en varias líneas:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">multigrupo</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="o">.</span>
              <span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;year&#39;</span><span class="p">,</span><span class="s1">&#39;continent&#39;</span><span class="p">])</span>
              <span class="p">[[</span><span class="s1">&#39;lifeExp&#39;</span><span class="p">,</span><span class="s1">&#39;gdpPercap&#39;</span><span class="p">]]</span><span class="o">.</span>
              <span class="n">mean</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">multigrupo</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                  lifeExp     gdpPercap
year continent                         
1952 Africa     39.135500   1252.572466
     Americas   53.279840   4079.062552
     Asia       46.314394   5195.484004
     Europe     64.408500   5661.057435
     Oceania    69.255000  10298.085650
</pre></div>
</div>
</div>
</div>
<p>Nota que <code class="docutils literal notranslate"><span class="pre">year</span></code> aparece una vez en la impresión. Si requieres tener un formato tabular (que se repita en cada fila, llamado <code class="docutils literal notranslate"><span class="pre">flatten</span></code>) puedes usar <code class="docutils literal notranslate"><span class="pre">reset_index</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">multigrupo</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   year continent    lifeExp     gdpPercap
0  1952    Africa  39.135500   1252.572466
1  1952  Americas  53.279840   4079.062552
2  1952      Asia  46.314394   5195.484004
3  1952    Europe  64.408500   5661.057435
4  1952   Oceania  69.255000  10298.085650
</pre></div>
</div>
</div>
</div>
<p>Para <strong>contar el número de casos</strong> usamos <code class="docutils literal notranslate"><span class="pre">.value_counts()</span></code> y para el número de valores únicos usamos <code class="docutils literal notranslate"><span class="pre">.nunique()</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;continent&#39;</span><span class="p">)[</span><span class="s1">&#39;country&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>continent  country    
Africa     Algeria        12
           Angola         12
           Libya          12
           Ghana          12
           Guinea         12
                          ..
Europe     Germany        12
           Greece         12
           Hungary        12
Oceania    Australia      12
           New Zealand    12
Name: count, Length: 142, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;continent&#39;</span><span class="p">)[</span><span class="s1">&#39;country&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>continent
Africa      52
Americas    25
Asia        33
Europe      30
Oceania      2
Name: country, dtype: int64
</pre></div>
</div>
</div>
</div>
</section>
<section id="wide-long">
<h3><span class="section-number">2.3.9. </span>Wide &amp; Long<a class="headerlink" href="#wide-long" title="Permalink to this heading">#</a></h3>
<p>Los datos <em>gapminder</em> que hemos analizado, están en un formato que se conoce como <code class="docutils literal notranslate"><span class="pre">long</span></code> o largo. Este tipo de formatos nos permite <em>pivotear</em>para obtener métricas de resumen de datos y agrupaciones (parecido a datos listos para usarse en una tabla dinámica de Excel). El resultado de las agrupaciones son datos en formato <code class="docutils literal notranslate"><span class="pre">wide</span></code>.</p>
<section id="pivot-table">
<h4><span class="section-number">2.3.9.1. </span>.pivot_table<a class="headerlink" href="#pivot-table" title="Permalink to this heading">#</a></h4>
<blockquote>
<div><p>Documentación pandas: https://pandas.pydata.org/docs/reference/api/pandas.pivot_table.html</p>
</div></blockquote>
<p>Devuelve un DataFrame reformado (<em>reshaped</em>) organizado por valores de índice/columna dados.</p>
<p>Ejercicio: Obtener la esperanza de vida <code class="docutils literal notranslate"><span class="pre">lifeExp</span></code> por cara año y país donde los continentes estén como columnas:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_wide</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span>
    <span class="n">index</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">,</span><span class="s1">&#39;country&#39;</span><span class="p">],</span>
    <span class="n">columns</span> <span class="o">=</span> <span class="s1">&#39;continent&#39;</span><span class="p">,</span>
    <span class="n">values</span> <span class="o">=</span> <span class="s1">&#39;lifeExp&#39;</span>
<span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df_wide</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>continent  year             country  Africa  Americas    Asia  Europe  Oceania
0          1952         Afghanistan     NaN       NaN  28.801     NaN      NaN
1          1952             Albania     NaN       NaN     NaN   55.23      NaN
2          1952             Algeria  43.077       NaN     NaN     NaN      NaN
3          1952              Angola  30.015       NaN     NaN     NaN      NaN
4          1952           Argentina     NaN    62.485     NaN     NaN      NaN
...         ...                 ...     ...       ...     ...     ...      ...
1699       2007             Vietnam     NaN       NaN  74.249     NaN      NaN
1700       2007  West Bank and Gaza     NaN       NaN  73.422     NaN      NaN
1701       2007         Yemen, Rep.     NaN       NaN  62.698     NaN      NaN
1702       2007              Zambia  42.384       NaN     NaN     NaN      NaN
1703       2007            Zimbabwe  43.487       NaN     NaN     NaN      NaN

[1704 rows x 7 columns]
</pre></div>
</div>
</div>
</div>
</section>
<section id="melt">
<h4><span class="section-number">2.3.9.2. </span>.melt<a class="headerlink" href="#melt" title="Permalink to this heading">#</a></h4>
<blockquote>
<div><p>Documentación pandas: https://pandas.pydata.org/docs/reference/api/pandas.melt.html</p>
</div></blockquote>
<p>Por otro lado, para volver de datos agrupados <code class="docutils literal notranslate"><span class="pre">wide</span></code> a un formato <code class="docutils literal notranslate"><span class="pre">long</span></code> tenemos:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_long</span> <span class="o">=</span> <span class="n">df_wide</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">id_vars</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">,</span><span class="s1">&#39;country&#39;</span><span class="p">])</span>
<span class="n">df_long</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>year</th>
      <th>country</th>
      <th>continent</th>
      <th>value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1952</td>
      <td>Afghanistan</td>
      <td>Africa</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1952</td>
      <td>Albania</td>
      <td>Africa</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1952</td>
      <td>Algeria</td>
      <td>Africa</td>
      <td>43.077</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1952</td>
      <td>Angola</td>
      <td>Africa</td>
      <td>30.015</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1952</td>
      <td>Argentina</td>
      <td>Africa</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Nota que <code class="docutils literal notranslate"><span class="pre">df_long</span></code> tiene valores perdidos y más registros (<code class="docutils literal notranslate"><span class="pre">shape</span></code>) que <code class="docutils literal notranslate"><span class="pre">df</span></code> porque hay valores <code class="docutils literal notranslate"><span class="pre">NaN</span></code>.</p>
<blockquote>
<div><p>Documentación pandas: https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.dropna.html</p>
</div></blockquote>
<p>Podemos borrarlos de la siguiente manera:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_long</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">inplace</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_long</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>year</th>
      <th>country</th>
      <th>continent</th>
      <th>value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>1952</td>
      <td>Algeria</td>
      <td>Africa</td>
      <td>43.077</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1952</td>
      <td>Angola</td>
      <td>Africa</td>
      <td>30.015</td>
    </tr>
    <tr>
      <th>10</th>
      <td>1952</td>
      <td>Benin</td>
      <td>Africa</td>
      <td>38.223</td>
    </tr>
    <tr>
      <th>13</th>
      <td>1952</td>
      <td>Botswana</td>
      <td>Africa</td>
      <td>47.622</td>
    </tr>
    <tr>
      <th>16</th>
      <td>1952</td>
      <td>Burkina Faso</td>
      <td>Africa</td>
      <td>31.975</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<blockquote>
<div><p>Ejercicio: obtener la mediana de la esperanza de vida y del PIB per cápita por continente y país (consejo: usa <code class="docutils literal notranslate"><span class="pre">.pivot_table</span></code>)</p>
</div></blockquote>
</section>
</section>
<section id="merge">
<h3><span class="section-number">2.3.10. </span>Merge<a class="headerlink" href="#merge" title="Permalink to this heading">#</a></h3>
<blockquote>
<div><p>Documentación pandas: https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.merge.html</p>
</div></blockquote>
<p>Para unir tablas se usa <code class="docutils literal notranslate"><span class="pre">merge</span></code>. Primero manejemos algunos atributos importantes de DataFrames:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([{</span><span class="s1">&#39;Nombre&#39;</span><span class="p">:</span> <span class="s1">&#39;Melani&#39;</span><span class="p">,</span> <span class="s1">&#39;Producto comprado&#39;</span><span class="p">:</span> <span class="s1">&#39;Esponja&#39;</span><span class="p">,</span> <span class="s1">&#39;Costo&#39;</span><span class="p">:</span> <span class="mf">22.50</span><span class="p">},</span>
                   <span class="p">{</span><span class="s1">&#39;Nombre&#39;</span><span class="p">:</span> <span class="s1">&#39;Carlos&#39;</span><span class="p">,</span> <span class="s1">&#39;Producto comprado&#39;</span><span class="p">:</span> <span class="s1">&#39;Arena para gatos&#39;</span><span class="p">,</span> <span class="s1">&#39;Costo&#39;</span><span class="p">:</span> <span class="mf">2.50</span><span class="p">},</span>
                   <span class="p">{</span><span class="s1">&#39;Nombre&#39;</span><span class="p">:</span> <span class="s1">&#39;Erica&#39;</span><span class="p">,</span> <span class="s1">&#39;Producto comprado&#39;</span><span class="p">:</span> <span class="s1">&#39;Cuchara&#39;</span><span class="p">,</span> <span class="s1">&#39;Costo&#39;</span><span class="p">:</span> <span class="mf">5.00</span><span class="p">}],</span>
                  <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Tienda 1&#39;</span><span class="p">,</span> <span class="s1">&#39;Tienda 1&#39;</span><span class="p">,</span> <span class="s1">&#39;Tienda 2&#39;</span><span class="p">])</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Nombre</th>
      <th>Producto comprado</th>
      <th>Costo</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Tienda 1</th>
      <td>Melani</td>
      <td>Esponja</td>
      <td>22.5</td>
    </tr>
    <tr>
      <th>Tienda 1</th>
      <td>Carlos</td>
      <td>Arena para gatos</td>
      <td>2.5</td>
    </tr>
    <tr>
      <th>Tienda 2</th>
      <td>Erica</td>
      <td>Cuchara</td>
      <td>5.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Podemos agregar una columna al <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> creado usando <code class="docutils literal notranslate"><span class="pre">df['variable']=[]</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Fecha&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Diciembre 1&#39;</span><span class="p">,</span> <span class="s1">&#39;Enero 1&#39;</span><span class="p">,</span> <span class="s1">&#39;mediado Mayo&#39;</span><span class="p">]</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Nombre</th>
      <th>Producto comprado</th>
      <th>Costo</th>
      <th>Fecha</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Tienda 1</th>
      <td>Melani</td>
      <td>Esponja</td>
      <td>22.5</td>
      <td>Diciembre 1</td>
    </tr>
    <tr>
      <th>Tienda 1</th>
      <td>Carlos</td>
      <td>Arena para gatos</td>
      <td>2.5</td>
      <td>Enero 1</td>
    </tr>
    <tr>
      <th>Tienda 2</th>
      <td>Erica</td>
      <td>Cuchara</td>
      <td>5.0</td>
      <td>mediado Mayo</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Si asignamos un único valor, por ejemplo <code class="docutils literal notranslate"><span class="pre">df['variable']=10</span></code>, se asigna el mismo valor a toda la columna:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Entregado&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Nombre</th>
      <th>Producto comprado</th>
      <th>Costo</th>
      <th>Fecha</th>
      <th>Entregado</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Tienda 1</th>
      <td>Melani</td>
      <td>Esponja</td>
      <td>22.5</td>
      <td>Diciembre 1</td>
      <td>True</td>
    </tr>
    <tr>
      <th>Tienda 1</th>
      <td>Carlos</td>
      <td>Arena para gatos</td>
      <td>2.5</td>
      <td>Enero 1</td>
      <td>True</td>
    </tr>
    <tr>
      <th>Tienda 2</th>
      <td>Erica</td>
      <td>Cuchara</td>
      <td>5.0</td>
      <td>mediado Mayo</td>
      <td>True</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Los valores perdidos se codifican como <code class="docutils literal notranslate"><span class="pre">None</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;CalificacionAtencion&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Positive&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;Negative&#39;</span><span class="p">]</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Nombre</th>
      <th>Producto comprado</th>
      <th>Costo</th>
      <th>Fecha</th>
      <th>Entregado</th>
      <th>CalificacionAtencion</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Tienda 1</th>
      <td>Melani</td>
      <td>Esponja</td>
      <td>22.5</td>
      <td>Diciembre 1</td>
      <td>True</td>
      <td>Positive</td>
    </tr>
    <tr>
      <th>Tienda 1</th>
      <td>Carlos</td>
      <td>Arena para gatos</td>
      <td>2.5</td>
      <td>Enero 1</td>
      <td>True</td>
      <td>None</td>
    </tr>
    <tr>
      <th>Tienda 2</th>
      <td>Erica</td>
      <td>Cuchara</td>
      <td>5.0</td>
      <td>mediado Mayo</td>
      <td>True</td>
      <td>Negative</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Usamos <code class="docutils literal notranslate"><span class="pre">reset_index()</span></code> para que las Tiendas ahora sean parte de las columnas y luego modificamos la columna fecha dejando un valor perdido en el índice <code class="docutils literal notranslate"><span class="pre">1</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">adf</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">adf</span><span class="p">[</span><span class="s1">&#39;Fecha&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="s1">&#39;Diciembre 1&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="s1">&#39;mediado Mayo&#39;</span><span class="p">})</span>
<span class="n">adf</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>Nombre</th>
      <th>Producto comprado</th>
      <th>Costo</th>
      <th>Fecha</th>
      <th>Entregado</th>
      <th>CalificacionAtencion</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Tienda 1</td>
      <td>Melani</td>
      <td>Esponja</td>
      <td>22.5</td>
      <td>Diciembre 1</td>
      <td>True</td>
      <td>Positive</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Tienda 1</td>
      <td>Carlos</td>
      <td>Arena para gatos</td>
      <td>2.5</td>
      <td>NaN</td>
      <td>True</td>
      <td>None</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Tienda 2</td>
      <td>Erica</td>
      <td>Cuchara</td>
      <td>5.0</td>
      <td>mediado Mayo</td>
      <td>True</td>
      <td>Negative</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Para ilustrar el uso de <strong>merge</strong> debemos crear dos <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">staff_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([{</span><span class="s1">&#39;Nombre&#39;</span><span class="p">:</span> <span class="s1">&#39;Carolina&#39;</span><span class="p">,</span> <span class="s1">&#39;Role&#39;</span><span class="p">:</span> <span class="s1">&#39;Directora de RRHH&#39;</span><span class="p">},</span>
                         <span class="p">{</span><span class="s1">&#39;Nombre&#39;</span><span class="p">:</span> <span class="s1">&#39;Salomé&#39;</span><span class="p">,</span> <span class="s1">&#39;Role&#39;</span><span class="p">:</span> <span class="s1">&#39;Vinculación&#39;</span><span class="p">},</span>
                         <span class="p">{</span><span class="s1">&#39;Nombre&#39;</span><span class="p">:</span> <span class="s1">&#39;Jacinto&#39;</span><span class="p">,</span> <span class="s1">&#39;Role&#39;</span><span class="p">:</span> <span class="s1">&#39;Evaluador&#39;</span><span class="p">}])</span>
<span class="n">staff_df</span> <span class="o">=</span> <span class="n">staff_df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;Nombre&#39;</span><span class="p">)</span>
<span class="n">student_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([{</span><span class="s1">&#39;Nombre&#39;</span><span class="p">:</span> <span class="s1">&#39;Jacinto&#39;</span><span class="p">,</span> <span class="s1">&#39;Carrera&#39;</span><span class="p">:</span> <span class="s1">&#39;Negocios&#39;</span><span class="p">},</span>
                           <span class="p">{</span><span class="s1">&#39;Nombre&#39;</span><span class="p">:</span> <span class="s1">&#39;Mauro&#39;</span><span class="p">,</span> <span class="s1">&#39;Carrera&#39;</span><span class="p">:</span> <span class="s1">&#39;Leyes&#39;</span><span class="p">},</span>
                           <span class="p">{</span><span class="s1">&#39;Nombre&#39;</span><span class="p">:</span> <span class="s1">&#39;Salomé&#39;</span><span class="p">,</span> <span class="s1">&#39;Carrera&#39;</span><span class="p">:</span> <span class="s1">&#39;Ingenieria&#39;</span><span class="p">}])</span>
<span class="n">student_df</span> <span class="o">=</span> <span class="n">student_df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;Nombre&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">staff_df</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">student_df</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                       Role
Nombre                     
Carolina  Directora de RRHH
Salomé          Vinculación
Jacinto           Evaluador

            Carrera
Nombre             
Jacinto    Negocios
Mauro         Leyes
Salomé   Ingenieria
</pre></div>
</div>
</div>
</div>
<p><strong>Tipos de <em>join</em></strong></p>
<a class="reference internal image-reference" href="_images/im2.png"><img alt="_images/im2.png" src="_images/im2.png" style="width: 700px; height: 300px;" /></a>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">staff_df</span><span class="p">,</span> <span class="n">student_df</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;outer&#39;</span><span class="p">,</span> <span class="n">left_index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">right_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Role</th>
      <th>Carrera</th>
    </tr>
    <tr>
      <th>Nombre</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Carolina</th>
      <td>Directora de RRHH</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Jacinto</th>
      <td>Evaluador</td>
      <td>Negocios</td>
    </tr>
    <tr>
      <th>Mauro</th>
      <td>NaN</td>
      <td>Leyes</td>
    </tr>
    <tr>
      <th>Salomé</th>
      <td>Vinculación</td>
      <td>Ingenieria</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">staff_df</span><span class="p">,</span> <span class="n">student_df</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">,</span> <span class="n">left_index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">right_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Role</th>
      <th>Carrera</th>
    </tr>
    <tr>
      <th>Nombre</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Salomé</th>
      <td>Vinculación</td>
      <td>Ingenieria</td>
    </tr>
    <tr>
      <th>Jacinto</th>
      <td>Evaluador</td>
      <td>Negocios</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">staff_df</span><span class="p">,</span> <span class="n">student_df</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">left_index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">right_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Role</th>
      <th>Carrera</th>
    </tr>
    <tr>
      <th>Nombre</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Carolina</th>
      <td>Directora de RRHH</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Salomé</th>
      <td>Vinculación</td>
      <td>Ingenieria</td>
    </tr>
    <tr>
      <th>Jacinto</th>
      <td>Evaluador</td>
      <td>Negocios</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">staff_df</span><span class="p">,</span> <span class="n">student_df</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="n">left_index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">right_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Role</th>
      <th>Carrera</th>
    </tr>
    <tr>
      <th>Nombre</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Jacinto</th>
      <td>Evaluador</td>
      <td>Negocios</td>
    </tr>
    <tr>
      <th>Mauro</th>
      <td>NaN</td>
      <td>Leyes</td>
    </tr>
    <tr>
      <th>Salomé</th>
      <td>Vinculación</td>
      <td>Ingenieria</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">staff_df</span> <span class="o">=</span> <span class="n">staff_df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">student_df</span> <span class="o">=</span> <span class="n">student_df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">staff_df</span><span class="p">,</span> <span class="n">student_df</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="s1">&#39;Nombre&#39;</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="s1">&#39;Nombre&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Nombre</th>
      <th>Role</th>
      <th>Carrera</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Carolina</td>
      <td>Directora de RRHH</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Salomé</td>
      <td>Vinculación</td>
      <td>Ingenieria</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Jacinto</td>
      <td>Evaluador</td>
      <td>Negocios</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="datos-categoricos">
<h3><span class="section-number">2.3.11. </span>Datos categóricos<a class="headerlink" href="#datos-categoricos" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([</span><span class="s1">&#39;A+&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;A-&#39;</span><span class="p">,</span> <span class="s1">&#39;B+&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;B-&#39;</span><span class="p">,</span> <span class="s1">&#39;C+&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;C-&#39;</span><span class="p">,</span> <span class="s1">&#39;D+&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">],</span>
                  <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;excelente&#39;</span><span class="p">,</span> <span class="s1">&#39;excelente&#39;</span><span class="p">,</span> <span class="s1">&#39;excelente&#39;</span><span class="p">,</span> <span class="s1">&#39;bueno&#39;</span><span class="p">,</span> <span class="s1">&#39;bueno&#39;</span><span class="p">,</span> <span class="s1">&#39;bueno&#39;</span><span class="p">,</span> <span class="s1">&#39;ok&#39;</span><span class="p">,</span> <span class="s1">&#39;ok&#39;</span><span class="p">,</span> <span class="s1">&#39;ok&#39;</span><span class="p">,</span> <span class="s1">&#39;bajo&#39;</span><span class="p">,</span> <span class="s1">&#39;bajo&#39;</span><span class="p">])</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>excelente</th>
      <td>A+</td>
    </tr>
    <tr>
      <th>excelente</th>
      <td>A</td>
    </tr>
    <tr>
      <th>excelente</th>
      <td>A-</td>
    </tr>
    <tr>
      <th>bueno</th>
      <td>B+</td>
    </tr>
    <tr>
      <th>bueno</th>
      <td>B</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="s1">&#39;Notas&#39;</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1">#cambia el nombre de &quot;0&quot; a &quot;Notas&quot;</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Notas</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>excelente</th>
      <td>A+</td>
    </tr>
    <tr>
      <th>excelente</th>
      <td>A</td>
    </tr>
    <tr>
      <th>excelente</th>
      <td>A-</td>
    </tr>
    <tr>
      <th>bueno</th>
      <td>B+</td>
    </tr>
    <tr>
      <th>bueno</th>
      <td>B</td>
    </tr>
    <tr>
      <th>bueno</th>
      <td>B-</td>
    </tr>
    <tr>
      <th>ok</th>
      <td>C+</td>
    </tr>
    <tr>
      <th>ok</th>
      <td>C</td>
    </tr>
    <tr>
      <th>ok</th>
      <td>C-</td>
    </tr>
    <tr>
      <th>bajo</th>
      <td>D+</td>
    </tr>
    <tr>
      <th>bajo</th>
      <td>D</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Notas&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>excelente    A+
excelente     A
excelente    A-
bueno        B+
bueno         B
Name: Notas, dtype: category
Categories (11, object): [&#39;A&#39;, &#39;A+&#39;, &#39;A-&#39;, &#39;B&#39;, ..., &#39;C+&#39;, &#39;C-&#39;, &#39;D&#39;, &#39;D+&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">notas</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Categorical</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">Notas</span><span class="p">,</span> <span class="n">categories</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="s1">&#39;D+&#39;</span><span class="p">,</span> <span class="s1">&#39;C-&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;C+&#39;</span><span class="p">,</span> <span class="s1">&#39;B-&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;B+&#39;</span><span class="p">,</span> <span class="s1">&#39;A-&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;A+&#39;</span><span class="p">],</span>
                              <span class="n">ordered</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">notas</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;A+&#39;, &#39;A&#39;, &#39;A-&#39;, &#39;B+&#39;, &#39;B&#39;, ..., &#39;C+&#39;, &#39;C&#39;, &#39;C-&#39;, &#39;D+&#39;, &#39;D&#39;]
Length: 11
Categories (11, object): [&#39;D&#39; &lt; &#39;D+&#39; &lt; &#39;C-&#39; &lt; &#39;C&#39; ... &#39;B+&#39; &lt; &#39;A-&#39; &lt; &#39;A&#39; &lt; &#39;A+&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">notas</span> <span class="o">&gt;</span> <span class="s1">&#39;C&#39;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([ True,  True,  True,  True,  True,  True,  True, False, False,
       False, False])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">uu</span> <span class="o">=</span> <span class="s2">&quot;https://raw.githubusercontent.com/vmoprojs/DataLectures/master/SpatialData/VABNoPetroleroCantones2007-2019.csv&quot;</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">uu</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>NOM_PROV</th>
      <th>COD_PROV</th>
      <th>NOM_CANT</th>
      <th>COD_CANT</th>
      <th>PRODUCCION</th>
      <th>CONSUMO_INTERMEDIO</th>
      <th>VAB</th>
      <th>YEAR</th>
      <th>TIPO</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>AZUAY</td>
      <td>1</td>
      <td>Cuenca</td>
      <td>101</td>
      <td>3.934100e+06</td>
      <td>1.829345e+06</td>
      <td>2.104755e+06</td>
      <td>2007</td>
      <td>Definitivo</td>
    </tr>
    <tr>
      <th>1</th>
      <td>AZUAY</td>
      <td>1</td>
      <td>Girón</td>
      <td>102</td>
      <td>4.362436e+04</td>
      <td>1.811613e+04</td>
      <td>2.550823e+04</td>
      <td>2007</td>
      <td>Definitivo</td>
    </tr>
    <tr>
      <th>2</th>
      <td>AZUAY</td>
      <td>1</td>
      <td>Gualaceo</td>
      <td>103</td>
      <td>1.451126e+05</td>
      <td>5.875048e+04</td>
      <td>8.636215e+04</td>
      <td>2007</td>
      <td>Definitivo</td>
    </tr>
    <tr>
      <th>3</th>
      <td>AZUAY</td>
      <td>1</td>
      <td>Nabón</td>
      <td>104</td>
      <td>5.595320e+04</td>
      <td>2.387684e+04</td>
      <td>3.207636e+04</td>
      <td>2007</td>
      <td>Definitivo</td>
    </tr>
    <tr>
      <th>4</th>
      <td>AZUAY</td>
      <td>1</td>
      <td>Paute</td>
      <td>105</td>
      <td>1.191381e+05</td>
      <td>5.077103e+04</td>
      <td>6.836707e+04</td>
      <td>2007</td>
      <td>Definitivo</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;YEAR&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">2019</span><span class="p">]</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;NOM_CANT&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">)[</span><span class="s1">&#39;VAB&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">agg</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">])</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;average&#39;</span><span class="p">:</span> <span class="s1">&#39;avg&#39;</span><span class="p">})</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
<span class="n">df</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>avg</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>2.190000e+02</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>4.304939e+05</td>
    </tr>
    <tr>
      <th>std</th>
      <td>2.286327e+06</td>
    </tr>
    <tr>
      <th>min</th>
      <td>4.037812e+03</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>2.730949e+04</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>6.001888e+04</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>1.902939e+05</td>
    </tr>
    <tr>
      <th>max</th>
      <td>2.503261e+07</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Para agrupar valores en intervalos discretos usamos <a class="reference external" href="https://pandas.pydata.org/docs/reference/api/pandas.cut.html"><code class="docutils literal notranslate"><span class="pre">pd.cut</span></code></a>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">cut</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;avg&#39;</span><span class="p">],</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>NOM_CANT
24 De Mayo                  (-20990.756, 2506894.639]
Aguarico                    (-20990.756, 2506894.639]
Alausí                      (-20990.756, 2506894.639]
Alfredo Baquerizo Moreno    (-20990.756, 2506894.639]
Ambato                      (-20990.756, 2506894.639]
                                      ...            
Yaguachi                    (-20990.756, 2506894.639]
Yanzatza                    (-20990.756, 2506894.639]
Zamora                      (-20990.756, 2506894.639]
Zapotillo                   (-20990.756, 2506894.639]
Zaruma                      (-20990.756, 2506894.639]
Name: avg, Length: 219, dtype: category
Categories (10, interval[float64, right]): [(-20990.756, 2506894.639] &lt; (2506894.639, 5009751.466] &lt; (5009751.466, 7512608.293] &lt; (7512608.293, 10015465.12] ... (15021178.774, 17524035.601] &lt; (17524035.601, 20026892.428] &lt; (20026892.428, 22529749.255] &lt; (22529749.255, 25032606.081]]
</pre></div>
</div>
</div>
</div>
</section>
<section id="tablas-dinamicas">
<h3><span class="section-number">2.3.12. </span>Tablas dinámicas<a class="headerlink" href="#tablas-dinamicas" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">uu</span> <span class="o">=</span> <span class="s2">&quot;https://raw.githubusercontent.com/vmoprojs/DataLectures/master/cars.csv&quot;</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">uu</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>YEAR</th>
      <th>Make</th>
      <th>Model</th>
      <th>Size</th>
      <th>(kW)</th>
      <th>Unnamed: 5</th>
      <th>TYPE</th>
      <th>CITY (kWh/100 km)</th>
      <th>HWY (kWh/100 km)</th>
      <th>COMB (kWh/100 km)</th>
      <th>CITY (Le/100 km)</th>
      <th>HWY (Le/100 km)</th>
      <th>COMB (Le/100 km)</th>
      <th>(g/km)</th>
      <th>RATING</th>
      <th>(km)</th>
      <th>TIME (h)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2012</td>
      <td>MITSUBISHI</td>
      <td>i-MiEV</td>
      <td>SUBCOMPACT</td>
      <td>49</td>
      <td>A1</td>
      <td>B</td>
      <td>16.9</td>
      <td>21.4</td>
      <td>18.7</td>
      <td>1.9</td>
      <td>2.4</td>
      <td>2.1</td>
      <td>0</td>
      <td>NaN</td>
      <td>100</td>
      <td>7</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2012</td>
      <td>NISSAN</td>
      <td>LEAF</td>
      <td>MID-SIZE</td>
      <td>80</td>
      <td>A1</td>
      <td>B</td>
      <td>19.3</td>
      <td>23.0</td>
      <td>21.1</td>
      <td>2.2</td>
      <td>2.6</td>
      <td>2.4</td>
      <td>0</td>
      <td>NaN</td>
      <td>117</td>
      <td>7</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2013</td>
      <td>FORD</td>
      <td>FOCUS ELECTRIC</td>
      <td>COMPACT</td>
      <td>107</td>
      <td>A1</td>
      <td>B</td>
      <td>19.0</td>
      <td>21.1</td>
      <td>20.0</td>
      <td>2.1</td>
      <td>2.4</td>
      <td>2.2</td>
      <td>0</td>
      <td>NaN</td>
      <td>122</td>
      <td>4</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2013</td>
      <td>MITSUBISHI</td>
      <td>i-MiEV</td>
      <td>SUBCOMPACT</td>
      <td>49</td>
      <td>A1</td>
      <td>B</td>
      <td>16.9</td>
      <td>21.4</td>
      <td>18.7</td>
      <td>1.9</td>
      <td>2.4</td>
      <td>2.1</td>
      <td>0</td>
      <td>NaN</td>
      <td>100</td>
      <td>7</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2013</td>
      <td>NISSAN</td>
      <td>LEAF</td>
      <td>MID-SIZE</td>
      <td>80</td>
      <td>A1</td>
      <td>B</td>
      <td>19.3</td>
      <td>23.0</td>
      <td>21.1</td>
      <td>2.2</td>
      <td>2.6</td>
      <td>2.4</td>
      <td>0</td>
      <td>NaN</td>
      <td>117</td>
      <td>7</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">values</span><span class="o">=</span><span class="s1">&#39;(kW)&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="s1">&#39;YEAR&#39;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="s1">&#39;Make&#39;</span><span class="p">,</span> <span class="n">aggfunc</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>Make</th>
      <th>BMW</th>
      <th>CHEVROLET</th>
      <th>FORD</th>
      <th>KIA</th>
      <th>MITSUBISHI</th>
      <th>NISSAN</th>
      <th>SMART</th>
      <th>TESLA</th>
    </tr>
    <tr>
      <th>YEAR</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2012</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>49.0</td>
      <td>80.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2013</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>107.0</td>
      <td>NaN</td>
      <td>49.0</td>
      <td>80.0</td>
      <td>35.0</td>
      <td>280.000000</td>
    </tr>
    <tr>
      <th>2014</th>
      <td>NaN</td>
      <td>104.0</td>
      <td>107.0</td>
      <td>NaN</td>
      <td>49.0</td>
      <td>80.0</td>
      <td>35.0</td>
      <td>268.333333</td>
    </tr>
    <tr>
      <th>2015</th>
      <td>125.0</td>
      <td>104.0</td>
      <td>107.0</td>
      <td>81.0</td>
      <td>49.0</td>
      <td>80.0</td>
      <td>35.0</td>
      <td>320.666667</td>
    </tr>
    <tr>
      <th>2016</th>
      <td>125.0</td>
      <td>104.0</td>
      <td>107.0</td>
      <td>81.0</td>
      <td>49.0</td>
      <td>80.0</td>
      <td>35.0</td>
      <td>409.700000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">values</span><span class="o">=</span><span class="s1">&#39;(kW)&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="s1">&#39;YEAR&#39;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="s1">&#39;Make&#39;</span><span class="p">,</span> <span class="n">aggfunc</span><span class="o">=</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">],</span> <span class="n">margins</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th colspan="9" halign="left">mean</th>
      <th colspan="9" halign="left">amin</th>
    </tr>
    <tr>
      <th>Make</th>
      <th>BMW</th>
      <th>CHEVROLET</th>
      <th>FORD</th>
      <th>KIA</th>
      <th>MITSUBISHI</th>
      <th>NISSAN</th>
      <th>SMART</th>
      <th>TESLA</th>
      <th>All</th>
      <th>BMW</th>
      <th>CHEVROLET</th>
      <th>FORD</th>
      <th>KIA</th>
      <th>MITSUBISHI</th>
      <th>NISSAN</th>
      <th>SMART</th>
      <th>TESLA</th>
      <th>All</th>
    </tr>
    <tr>
      <th>YEAR</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2012</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>49.0</td>
      <td>80.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>64.500000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>49.0</td>
      <td>80.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>49</td>
    </tr>
    <tr>
      <th>2013</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>107.0</td>
      <td>NaN</td>
      <td>49.0</td>
      <td>80.0</td>
      <td>35.0</td>
      <td>280.000000</td>
      <td>158.444444</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>107.0</td>
      <td>NaN</td>
      <td>49.0</td>
      <td>80.0</td>
      <td>35.0</td>
      <td>270.0</td>
      <td>35</td>
    </tr>
    <tr>
      <th>2014</th>
      <td>NaN</td>
      <td>104.0</td>
      <td>107.0</td>
      <td>NaN</td>
      <td>49.0</td>
      <td>80.0</td>
      <td>35.0</td>
      <td>268.333333</td>
      <td>135.000000</td>
      <td>NaN</td>
      <td>104.0</td>
      <td>107.0</td>
      <td>NaN</td>
      <td>49.0</td>
      <td>80.0</td>
      <td>35.0</td>
      <td>225.0</td>
      <td>35</td>
    </tr>
    <tr>
      <th>2015</th>
      <td>125.0</td>
      <td>104.0</td>
      <td>107.0</td>
      <td>81.0</td>
      <td>49.0</td>
      <td>80.0</td>
      <td>35.0</td>
      <td>320.666667</td>
      <td>181.428571</td>
      <td>125.0</td>
      <td>104.0</td>
      <td>107.0</td>
      <td>81.0</td>
      <td>49.0</td>
      <td>80.0</td>
      <td>35.0</td>
      <td>280.0</td>
      <td>35</td>
    </tr>
    <tr>
      <th>2016</th>
      <td>125.0</td>
      <td>104.0</td>
      <td>107.0</td>
      <td>81.0</td>
      <td>49.0</td>
      <td>80.0</td>
      <td>35.0</td>
      <td>409.700000</td>
      <td>252.263158</td>
      <td>125.0</td>
      <td>104.0</td>
      <td>107.0</td>
      <td>81.0</td>
      <td>49.0</td>
      <td>80.0</td>
      <td>35.0</td>
      <td>283.0</td>
      <td>35</td>
    </tr>
    <tr>
      <th>All</th>
      <td>125.0</td>
      <td>104.0</td>
      <td>107.0</td>
      <td>81.0</td>
      <td>49.0</td>
      <td>80.0</td>
      <td>35.0</td>
      <td>345.478261</td>
      <td>190.622642</td>
      <td>125.0</td>
      <td>104.0</td>
      <td>107.0</td>
      <td>81.0</td>
      <td>49.0</td>
      <td>80.0</td>
      <td>35.0</td>
      <td>225.0</td>
      <td>35</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="apply">
<h3><span class="section-number">2.3.13. </span>Apply<a class="headerlink" href="#apply" title="Permalink to this heading">#</a></h3>
<blockquote>
<div><p>Documentación pandas: https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.apply.html</p>
</div></blockquote>
<p>Cuando trabajas con DataFrames es posible que requieras aplicar funciones en filas o columnas.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">],</span><span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">]})</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   a  b
0  2  2
1  4  3
2  6  5
</pre></div>
</div>
</div>
</div>
<p>Creamos una función simple llamada <code class="docutils literal notranslate"><span class="pre">cuad</span></code> que eleva los valores ingresados al cuadrado:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">cuad</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="n">sol</span> <span class="o">=</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span>
    <span class="k">return</span><span class="p">(</span><span class="n">sol</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Aplicamos la función creada en la columna <code class="docutils literal notranslate"><span class="pre">a</span></code> del DataFrame</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">cuad</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0     4
1    16
2    36
Name: a, dtype: int64
</pre></div>
</div>
</div>
</div>
<p>Ahora creamos una función que tenga dos parámetros:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">cuad_e</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">e</span><span class="p">):</span>
    <span class="n">sol</span> <span class="o">=</span> <span class="n">x</span><span class="o">**</span><span class="n">e</span>
    <span class="k">return</span><span class="p">(</span><span class="n">sol</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">cuad_e</span><span class="p">,</span><span class="n">e</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0      8
1     64
2    216
Name: a, dtype: int64
</pre></div>
</div>
</div>
</div>
<p>Nota que al aplicar las funciones anteriores estábamos trabajando sobre objetos tipo <code class="docutils literal notranslate"><span class="pre">Series</span></code>.</p>
<p>Si queremos aplicar una función sobre varias columnas del DataFrame, usamos el parámetro <code class="docutils literal notranslate"><span class="pre">axis=0</span></code> para aplicar la función por cada columna:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">cuad</span><span class="p">,</span><span class="n">axis</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>a</th>
      <th>b</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>4</td>
      <td>4</td>
    </tr>
    <tr>
      <th>1</th>
      <td>16</td>
      <td>9</td>
    </tr>
    <tr>
      <th>2</th>
      <td>36</td>
      <td>25</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>De manera similar, si queremos aplicar una función sobre varias filas del DataFrame, usamos el parámetro <code class="docutils literal notranslate"><span class="pre">axis=1</span></code> para aplicar la función por cada fila:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">cuad_e</span><span class="p">,</span><span class="n">axis</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span><span class="n">e</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>a</th>
      <th>b</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>4</td>
      <td>4</td>
    </tr>
    <tr>
      <th>1</th>
      <td>16</td>
      <td>9</td>
    </tr>
    <tr>
      <th>2</th>
      <td>36</td>
      <td>25</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0     4
1    16
2    36
Name: a, dtype: int64
</pre></div>
</div>
</div>
</div>
<p>A veces la función que deseamos aplicar no es tan compleja tal que no requiere que la creemos por separado. En este caso podemos usar <code class="docutils literal notranslate"><span class="pre">lambda</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0   -1.585786
1   -1.000000
2   -0.550510
Name: a, dtype: float64
</pre></div>
</div>
</div>
</div>
<section id="concat">
<h4><span class="section-number">2.3.13.1. </span>.concat<a class="headerlink" href="#concat" title="Permalink to this heading">#</a></h4>
<blockquote>
<div><p>Documentación pandas: https://pandas.pydata.org/docs/reference/api/pandas.concat.html</p>
</div></blockquote>
<p>La concatenación nos permite concatenar filas o columnas de diferentes conjuntos de datos.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;a0&#39;</span><span class="p">,</span><span class="s1">&#39;a1&#39;</span><span class="p">,</span><span class="s1">&#39;a2&#39;</span><span class="p">,</span><span class="s1">&#39;a3&#39;</span><span class="p">],</span>
                   <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;b0&#39;</span><span class="p">,</span><span class="s1">&#39;b1&#39;</span><span class="p">,</span><span class="s1">&#39;b2&#39;</span><span class="p">,</span><span class="s1">&#39;b3&#39;</span><span class="p">],</span>
                   <span class="s1">&#39;C&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;c0&#39;</span><span class="p">,</span><span class="s1">&#39;c1&#39;</span><span class="p">,</span><span class="s1">&#39;c2&#39;</span><span class="p">,</span><span class="s1">&#39;c3&#39;</span><span class="p">],</span>
                   <span class="s1">&#39;D&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;d0&#39;</span><span class="p">,</span><span class="s1">&#39;d1&#39;</span><span class="p">,</span><span class="s1">&#39;d2&#39;</span><span class="p">,</span><span class="s1">&#39;d3&#39;</span><span class="p">]})</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df1</span><span class="p">)</span>

<span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;a4&#39;</span><span class="p">,</span><span class="s1">&#39;a5&#39;</span><span class="p">,</span><span class="s1">&#39;a7&#39;</span><span class="p">,</span><span class="s1">&#39;a7&#39;</span><span class="p">],</span>
                   <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;b4&#39;</span><span class="p">,</span><span class="s1">&#39;b5&#39;</span><span class="p">,</span><span class="s1">&#39;b6&#39;</span><span class="p">,</span><span class="s1">&#39;b7&#39;</span><span class="p">],</span>
                   <span class="s1">&#39;C&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;c4&#39;</span><span class="p">,</span><span class="s1">&#39;c5&#39;</span><span class="p">,</span><span class="s1">&#39;c6&#39;</span><span class="p">,</span><span class="s1">&#39;c7&#39;</span><span class="p">],</span>
                   <span class="s1">&#39;D&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;d4&#39;</span><span class="p">,</span><span class="s1">&#39;d5&#39;</span><span class="p">,</span><span class="s1">&#39;d6&#39;</span><span class="p">,</span><span class="s1">&#39;d7&#39;</span><span class="p">]})</span>

<span class="nb">print</span><span class="p">(</span><span class="n">df2</span><span class="p">)</span>
<span class="n">df3</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;a8&#39;</span><span class="p">,</span><span class="s1">&#39;a9&#39;</span><span class="p">,</span><span class="s1">&#39;a10&#39;</span><span class="p">,</span><span class="s1">&#39;a11&#39;</span><span class="p">],</span>
                   <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;b8&#39;</span><span class="p">,</span><span class="s1">&#39;b9&#39;</span><span class="p">,</span><span class="s1">&#39;b10&#39;</span><span class="p">,</span><span class="s1">&#39;b11&#39;</span><span class="p">],</span>
                   <span class="s1">&#39;C&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;c8&#39;</span><span class="p">,</span><span class="s1">&#39;c9&#39;</span><span class="p">,</span><span class="s1">&#39;c10&#39;</span><span class="p">,</span><span class="s1">&#39;c11&#39;</span><span class="p">],</span>
                   <span class="s1">&#39;D&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;d8&#39;</span><span class="p">,</span><span class="s1">&#39;d9&#39;</span><span class="p">,</span><span class="s1">&#39;d10&#39;</span><span class="p">,</span><span class="s1">&#39;d11&#39;</span><span class="p">]})</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    A   B   C   D
0  a0  b0  c0  d0
1  a1  b1  c1  d1
2  a2  b2  c2  d2
3  a3  b3  c3  d3
    A   B   C   D
0  a4  b4  c4  d4
1  a5  b5  c5  d5
2  a7  b6  c6  d6
3  a7  b7  c7  d7
     A    B    C    D
0   a8   b8   c8   d8
1   a9   b9   c9   d9
2  a10  b10  c10  d10
3  a11  b11  c11  d11
</pre></div>
</div>
</div>
</div>
<p>El <code class="docutils literal notranslate"><span class="pre">index</span></code> del DataFrame es un <code class="docutils literal notranslate"><span class="pre">axis</span></code> del DataFrame. Pandas tratará de alinear los datos por <code class="docutils literal notranslate"><span class="pre">axis</span></code>. El otro <code class="docutils literal notranslate"><span class="pre">axis</span></code> del DataFrame es <code class="docutils literal notranslate"><span class="pre">columns</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df1</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;A&#39;, &#39;B&#39;, &#39;C&#39;, &#39;D&#39;], dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df1</span><span class="o">.</span><span class="n">index</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>RangeIndex(start=0, stop=4, step=1)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df1</span><span class="o">.</span><span class="n">values</span><span class="c1"># representa el cuerpo del dataframe como array</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[&#39;a0&#39;, &#39;b0&#39;, &#39;c0&#39;, &#39;d0&#39;],
       [&#39;a1&#39;, &#39;b1&#39;, &#39;c1&#39;, &#39;d1&#39;],
       [&#39;a2&#39;, &#39;b2&#39;, &#39;c2&#39;, &#39;d2&#39;],
       [&#39;a3&#39;, &#39;b3&#39;, &#39;c3&#39;, &#39;d3&#39;]], dtype=object)
</pre></div>
</div>
</div>
</div>
<p>Para concatenar por filas:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">row_concat</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df1</span><span class="p">,</span><span class="n">df2</span><span class="p">,</span><span class="n">df3</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">row_concat</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     A    B    C    D
0   a0   b0   c0   d0
1   a1   b1   c1   d1
2   a2   b2   c2   d2
3   a3   b3   c3   d3
0   a4   b4   c4   d4
1   a5   b5   c5   d5
2   a7   b6   c6   d6
3   a7   b7   c7   d7
0   a8   b8   c8   d8
1   a9   b9   c9   d9
2  a10  b10  c10  d10
3  a11  b11  c11  d11
</pre></div>
</div>
</div>
</div>
<p>Nota que el índice del DataFrame concatenado se repite.</p>
<blockquote>
<div><p>Usa <code class="docutils literal notranslate"><span class="pre">.loc[]</span></code> para indexar valores del DataFrame</p>
</div></blockquote>
<p>Ahora creamos una nueva fila de datos que deseamos agregar al DataFrame:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">new_row_series</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="s1">&#39;a12&#39;</span><span class="p">,</span><span class="s1">&#39;b12&#39;</span><span class="p">,</span><span class="s1">&#39;c12&#39;</span><span class="p">,</span><span class="s1">&#39;d12&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df1</span><span class="p">,</span><span class="n">new_row_series</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     A    B    C    D    0
0   a0   b0   c0   d0  NaN
1   a1   b1   c1   d1  NaN
2   a2   b2   c2   d2  NaN
3   a3   b3   c3   d3  NaN
0  NaN  NaN  NaN  NaN  a12
1  NaN  NaN  NaN  NaN  b12
2  NaN  NaN  NaN  NaN  c12
3  NaN  NaN  NaN  NaN  d12
</pre></div>
</div>
</div>
</div>
<p>Nota que no se obtuvo el resultado deseado y se obtuvo una columna extra.</p>
<p>Para arreglar este problema, convertimos esta serie tipo fila en un DataFrame:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">new_row_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="c1"># nota el doble corchete para crear datos tipo fila</span>
    <span class="n">data</span> <span class="o">=</span> <span class="p">[[</span><span class="s1">&#39;a12&#39;</span><span class="p">,</span><span class="s1">&#39;b12&#39;</span><span class="p">,</span><span class="s1">&#39;c12&#39;</span><span class="p">,</span><span class="s1">&#39;d12&#39;</span><span class="p">]],</span>
    <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">,</span><span class="s2">&quot;B&quot;</span><span class="p">,</span><span class="s2">&quot;C&quot;</span><span class="p">,</span><span class="s2">&quot;D&quot;</span><span class="p">]</span>
<span class="p">)</span>
<span class="n">new_row_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>a12</td>
      <td>b12</td>
      <td>c12</td>
      <td>d12</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df1</span><span class="p">,</span><span class="n">new_row_df</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>a0</td>
      <td>b0</td>
      <td>c0</td>
      <td>d0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>a1</td>
      <td>b1</td>
      <td>c1</td>
      <td>d1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>a2</td>
      <td>b2</td>
      <td>c2</td>
      <td>d2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>a3</td>
      <td>b3</td>
      <td>c3</td>
      <td>d3</td>
    </tr>
    <tr>
      <th>0</th>
      <td>a12</td>
      <td>b12</td>
      <td>c12</td>
      <td>d12</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Para <strong>concatenar por columnas</strong>, usamos <code class="docutils literal notranslate"><span class="pre">axis</span> <span class="pre">=</span> <span class="pre">'columns'</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">col_concat</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df1</span><span class="p">,</span><span class="n">df2</span><span class="p">,</span><span class="n">df3</span><span class="p">],</span><span class="n">axis</span> <span class="o">=</span> <span class="s1">&#39;columns&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">col_concat</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    A   B   C   D   A   B   C   D    A    B    C    D
0  a0  b0  c0  d0  a4  b4  c4  d4   a8   b8   c8   d8
1  a1  b1  c1  d1  a5  b5  c5  d5   a9   b9   c9   d9
2  a2  b2  c2  d2  a7  b6  c6  d6  a10  b10  c10  d10
3  a3  b3  c3  d3  a7  b7  c7  d7  a11  b11  c11  d11
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">col_concat</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    A   A    A
0  a0  a4   a8
1  a1  a5   a9
2  a2  a7  a10
3  a3  a7  a11
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  <!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="IntroduccionPython.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">1. </span>Python, una introducción</p>
      </div>
    </a>
    <a class="right-next"
       href="Visualizacion.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">3. </span>Gráficos básicos: matplotlib &amp; seaborn</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#las-series">2.1. Las Series</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#haciendo-consultas-en-series">2.2. Haciendo consultas en Series</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pandas-estructuras-de-datos-para-estadistica">2.3. Pandas: estructuras de datos para estadística</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#manipulacion-de-datos">2.3.1. Manipulación de datos</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cargando-nuestro-primer-conjunto-de-datos">2.3.2. Cargando nuestro primer conjunto de datos</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#columnas-filas-y-celdas">2.3.3. Columnas, filas y celdas</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#seleccionar-e-indexar-columnas-por-nombre">2.3.4. Seleccionar e indexar columnas por nombre</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#usando-notacion-para-acceder-a-valores-de-columna">2.3.5. Usando notación “.” para acceder a valores de columna</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#subconjunto-de-filas">2.3.6. Subconjunto de filas</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#usando-iloc">2.3.7. Usando <code class="docutils literal notranslate"><span class="pre">.iloc</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#agrupaciones">2.3.8. Agrupaciones</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#wide-long">2.3.9. Wide &amp; Long</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pivot-table">2.3.9.1. .pivot_table</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#melt">2.3.9.2. .melt</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#merge">2.3.10. Merge</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#datos-categoricos">2.3.11. Datos categóricos</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tablas-dinamicas">2.3.12. Tablas dinámicas</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#apply">2.3.13. Apply</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#concat">2.3.13.1. .concat</a></li>
</ul>
</li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            <div class="bd-footer-content__inner">
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Víctor Morales Oñate
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div></div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=12da95d707ffb74b382d"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=12da95d707ffb74b382d"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>